import { expect, test, vi } from 'vitest'
import { POST } from "./route";

const payloads = {
  signTransaction: {
    body: {
      trustedData: {
        messageBytes: '0a8b02080d10df920e18d6f6842f20018201fa010ad90168747470733a2f2f6672616d652d77616c6c65742e76657263656c2e6170702f76312f363336306330306231346630636133323761393965306437636566303030616632636266393330333565663931396433316166303162396662383032616662343965363831643435663633333330326364393236616266653064353961306261373236363563376361353135666231653836343332323432346666393465336439386631666332373365303361633637396432323630303534333032303137393936306238663739333731303332303431373030303010011a1a08df920e1214000000000000000000000000000000000000000112141f2d2c6360a0a01b81898b98f81e5239fc14de5718012240f313ddbafe68c3ae9ff65f5c145bd8f56036b62f5218bedad8a82ef85930948c8f327e92591c1cb1d99a4131b36df87f14ecf53bcdb0d8e6430aab923d7818042801322031351506585341467af8e18295bbd3eea2d5ea942edaf612f915f8e9cf639419'
      },
    },
    params: {
      compressedPartialUserOp: "6360c00b14f0ca327a99e0d7cef000af2cbf93035ef919d31af01b9fb802afb49e681d45f633302cd926abfe0d59a0ba72665c7ca515fb1e864322424ff94e3d98f1fc273e03ac679d22600543020179960b8f7937103204170000",
    },
  },
};

test('send transaction', async () => {
  const req = {
    nextUrl: {
      searchParams: {
        get: vi.fn(),
      },
    },
    json: vi.fn(() => {
      return Promise.resolve(payloads.signTransaction.body);
    }),
  };
  
  const response = await POST(req, { params: payloads.signTransaction.params });
  console.log('RESPONSE');
  console.log(response.status);
  console.log(await response.text());
});
